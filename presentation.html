<!DOCTYPE html>
<html lang="en"><head>
<script src="presentation_files/libs/clipboard/clipboard.min.js"></script>
<script src="presentation_files/libs/quarto-html/tabby.min.js"></script>
<script src="presentation_files/libs/quarto-html/popper.min.js"></script>
<script src="presentation_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="presentation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="presentation_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="presentation_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.1.251">

  <meta name="author" content="George Savva (Quadram Institute Bioscience)">
  <title>Linear Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link rel="stylesheet" href="custom.css">
  <link href="presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">Linear Models</h1>
  <p class="author">George Savva (Quadram Institute Bioscience)</p>
</section>

<section>
<section id="introduction" class="title-slide slide level1 center">
<h1>Introduction</h1>

</section>
<section id="session-outline" class="slide level2">
<h2>Session outline</h2>
<ul>
<li>Understanding linear models</li>
<li>Rethinking statistics in terms of LMs</li>
<li>Examples, discussion and practical work with R</li>
</ul>
</section>
<section id="getting-our-r-packages" class="slide level2">
<h2>Getting our R packages</h2>
<p>Start RStudio..</p>
<p>Make sure you have these packages installed..</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"UsingR"</span>, <span class="st">"equatiomatic"</span>, <span class="st">"emmeans"</span>, <span class="st">"broom"</span>, </span>
<span id="cb1-2"><a href="#cb1-2"></a>                   <span class="st">"performance"</span>, <span class="st">"ggplot2"</span>, <span class="st">"gamlss"</span>, <span class="st">"car"</span>,</span>
<span id="cb1-3"><a href="#cb1-3"></a>                   <span class="st">"patchwork"</span>, <span class="st">"ggbeeswarm"</span>, <span class="st">"readxl"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(UsingR) <span class="co"># dataset</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">library</span>(readxl) <span class="co"># reading data from excel files</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">library</span>(equatiomatic) <span class="co"># making equations from models</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">library</span>(emmeans) <span class="co"># marginal means</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="fu">library</span>(broom) <span class="co"># enhancements to model</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">library</span>(performance) <span class="co"># model diagnostics</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="fu">library</span>(ggplot2) <span class="co"># making graphs</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="fu">library</span>(gamlss) <span class="co"># enhanced modelling</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="fu">library</span>(car)    <span class="co"># hypothesis tests </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="fu">library</span>(ggbeeswarm) <span class="co"># beeswarm graphs</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="fu">library</span>(patchwork) <span class="co"># place plots side-by-side</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="files-for-the-session" class="slide level2">
<h2>Files for the session:</h2>
<p>Data:</p>
<ul>
<li><code>diversity.csv</code></li>
<li><code>survey.csv</code></li>
<li><code>observations.csv</code></li>
</ul>
<p>Code, slides and handouts:</p>
<ul>
<li><code>presentation.qmd</code></li>
<li><code>presentation.html</code></li>
<li><code>linearmodels.pptx</code></li>
</ul>
</section>
<section id="what-is-a-linear-model" class="slide level2">
<h2>What is a linear model?</h2>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</div>
</div>
<ul>
<li>What questions might we ask?</li>
<li>What form could the answer take?</li>
</ul>
</div>
</section>
<section id="what-is-a-linear-model-1" class="slide level2">
<h2>What is a linear model?</h2>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"><p><span class="math display">\[\text{Height}=a+b\times \text{Age}\]</span></p>
</section>
<section id="what-is-a-linear-model-2" class="slide level2">
<h2>What is a linear model</h2>
<ul>
<li><p>Describes a linear relationship between an <span style="color:lightblue">outcome</span> and its <span style="color:lightgreen">predictors</span>.</p></li>
<li><p>What is the model for?</p></li>
<li><p>Who is interested and what will it be used for?</p></li>
</ul>
</section>
<section id="fitting-our-model-in-r" class="slide level2">
<h2>Fitting our model in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( height <span class="sc">~</span> age , <span class="at">data =</span> kid.weights )</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">extract_eq</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{height} = \alpha + \beta_{1}(\operatorname{age}) + \epsilon
\]</span></p>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">tidy</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   25.0     0.472        52.9 4.49e-137
2 age            0.241   0.00758      31.7 2.56e- 89</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">extract_eq</span>(model1, <span class="at">use_coefs=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{height}} = 24.98 + 0.24(\operatorname{age})
\]</span></p>
</div>
</div>
</div>
</section>
<section id="what-can-we-do-with-this" class="slide level2">
<h2>What can we do with this?</h2>
<div>
<ul>
<li class="fragment">Describe the relationship?</li>
<li class="fragment">Predict new values of height from age?</li>
</ul>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>newages <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">12</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>))</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>model1 <span class="sc">|&gt;</span> <span class="fu">predict</span> (<span class="at">newdata =</span> newages) <span class="sc">|&gt;</span> <span class="fu">cbind</span>(newages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   predict(model1, newdata = newages) age
1                            27.87171  12
2                            30.75998  24
3                            33.64825  36
4                            36.53652  48
5                            39.42478  60
6                            42.31305  72
7                            45.20132  84
8                            48.08959  96
9                            50.97786 108
10                           53.86613 120
11                           56.75440 132
12                           59.64267 144
13                           62.53094 156
14                           65.41921 168
15                           68.30748 180
16                           71.19574 192
17                           74.08401 204
18                           76.97228 216
19                           79.86055 228
20                           82.74882 240</code></pre>
</div>
</div>
</section>
<section id="prediction-intervals" class="slide level2">
<h2>Prediction intervals</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>model1 <span class="sc">|&gt;</span> <span class="fu">augment</span>(<span class="at">interval=</span><span class="st">"prediction"</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>age,<span class="at">y=</span>height))   <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">18</span>)<span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">geom_ribbon</span>( <span class="fu">aes</span>(<span class="at">y=</span>.fitted, <span class="at">ymin=</span>.lower, <span class="at">ymax=</span>.upper), <span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">fill=</span><span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">geom_line</span>( <span class="fu">aes</span>(<span class="at">y=</span>.fitted)) <span class="sc">+</span> </span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Age (months)"</span>,<span class="at">y=</span><span class="st">"Height (ins)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/addingpredictions-1.png" width="960" class="r-stretch"></section>
<section id="confidence-intervals" class="slide level2">
<h2>Confidence intervals</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>model1 <span class="sc">|&gt;</span> <span class="fu">augment</span>(<span class="at">interval=</span><span class="st">"confidence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>age,<span class="at">y=</span>height))   <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">18</span>)<span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">geom_ribbon</span>( <span class="fu">aes</span>(<span class="at">y=</span>.fitted, <span class="at">ymin=</span>.lower, <span class="at">ymax=</span>.upper), <span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">fill=</span><span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">geom_line</span>( <span class="fu">aes</span>(<span class="at">y=</span>.fitted)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Age (months)"</span>,<span class="at">y=</span><span class="st">"Height (ins)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/addingconfidence-1.png" width="960" class="r-stretch"></section>
<section id="our-model-is-done" class="slide level2">
<h2>Our model is done:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">extract_eq</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{height} = \alpha + \beta_{1}(\operatorname{age}) + \epsilon
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">extract_eq</span>(model1, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{height}} = 24.98 + 0.24(\operatorname{age})
\]</span></p>
</div>
</div>
<p>Standard deviation of ‘error’ = 4.77</p>
<p><span class="math display">\[\epsilon \sim N(0,4.77^2)\]</span></p>
</section>
<section id="summary-1" class="slide level2">
<h2>Summary 1</h2>
<div>
<ul>
<li class="fragment"><p>A linear model describes the linear relationship between an outcome and predictors</p></li>
<li class="fragment"><p>Can be used for prediction or inference</p></li>
<li class="fragment"><p>Simple linear models are fit in R using <code>lm</code>.</p></li>
<li class="fragment"><p><code>broom::augment</code> makes it easy to get predictions.</p></li>
<li class="fragment"><p>Visualisations allow us to check model fit.</p></li>
<li class="fragment"><p>Confidence intervals reflect uncertainty around means</p></li>
<li class="fragment"><p>Prediction intervals reflect likely variation in new points</p></li>
</ul>
</div>
</section>
<section id="example-2---weight-by-age" class="slide level2">
<h2>Example 2 - Weight by Age</h2>
<p>Can we apply the same method to this dataset?</p>
<p>Can you forsee a problem?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">ggplot</span>(kid.weights, <span class="fu">aes</span>(<span class="at">x=</span>age,<span class="at">y=</span>weight))   <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">18</span>)<span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Age (months)"</span>,<span class="at">y=</span><span class="st">"Weight (lbs)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="example-2" class="slide level2">
<h2>Example 2</h2>
<p>What are the limitations of the ‘regular’ linear model?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>( weight <span class="sc">~</span> age , <span class="at">data =</span> kid.weights )</span>
<span id="cb14-2"><a href="#cb14-2"></a>model2 <span class="sc">|&gt;</span> <span class="fu">augment</span>(<span class="at">interval=</span><span class="st">"prediction"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>age,<span class="at">y=</span>weight))<span class="sc">+</span><span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">18</span>)<span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted, <span class="at">ymin=</span>.lower, <span class="at">ymax=</span>.upper),<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">fill=</span><span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">geom_line</span>( <span class="fu">aes</span>(<span class="at">y=</span>.fitted)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Age (months)"</span>,<span class="at">y=</span><span class="st">"Weight (lbs)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section id="enhancing-our-model-1" class="slide level2">
<h2>Enhancing our model 1</h2>
<p>We can model how the error term changes with age.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>model2b <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( weight <span class="sc">~</span> age , <span class="at">sigma.formula =</span> <span class="sc">~</span>age ,</span>
<span id="cb15-2"><a href="#cb15-2"></a>                   <span class="at">data =</span> kid.weights, <span class="at">control =</span> <span class="fu">gamlss.control</span>(<span class="at">trace=</span>F))</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="fu">centiles.fan</span>(model2b, <span class="at">cent=</span><span class="fu">c</span>(<span class="fl">2.5</span>,<span class="fl">97.5</span>))</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="fu">points</span>(kid.weights<span class="sc">$</span>age , kid.weights<span class="sc">$</span>weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section id="enhancing-our-model-1-1" class="slide level2">
<h2>Enhancing our model 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">summary</span>(model2b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("NO", "Normal") 

Call:  gamlss(formula = weight ~ age, sigma.formula = ~age,  
    data = kid.weights, control = gamlss.control(trace = F)) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  identity
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  13.9963     0.4337   32.27   &lt;2e-16 ***
age           0.4910     0.0160   30.69   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  log
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.087779   0.067469   16.12   &lt;2e-16 ***
age         0.017055   0.001047   16.28   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  250 
Degrees of Freedom for the fit:  4
      Residual Deg. of Freedom:  246 
                      at cycle:  3 
 
Global Deviance:     1662.226 
            AIC:     1670.226 
            SBC:     1684.312 
******************************************************************</code></pre>
</div>
</div>
</section>
<section id="enhancing-our-model-2" class="slide level2">
<h2>Enhancing our model 2</h2>
<p>We can also model how the <em>skew</em> changes with age!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>model2c <span class="ot">&lt;-</span> <span class="fu">gamlss</span>( weight <span class="sc">~</span> age , <span class="at">sigma.formula =</span> <span class="sc">~</span>age , <span class="at">nu.formula =</span> <span class="sc">~</span>age ,</span>
<span id="cb18-2"><a href="#cb18-2"></a>            <span class="at">data =</span> kid.weights , <span class="at">family=</span><span class="st">"BCPE"</span>, <span class="at">control =</span> <span class="fu">gamlss.control</span>(<span class="at">trace=</span>F))</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="fu">centiles.fan</span>(model2c, <span class="at">cent=</span><span class="fu">c</span>(<span class="fl">2.5</span>,<span class="fl">97.5</span>))</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="fu">points</span>(kid.weights<span class="sc">$</span>age , kid.weights<span class="sc">$</span>weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="enhancing-our-model-2-1" class="slide level2">
<h2>Enhancing our model 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">summary</span>(model2c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>******************************************************************
Family:  c("BCPE", "Box-Cox Power Exponential") 

Call:  gamlss(formula = weight ~ age, sigma.formula = ~age,  
    nu.formula = ~age, family = "BCPE", data = kid.weights,  
    control = gamlss.control(trace = F)) 

Fitting method: RS() 

------------------------------------------------------------------
Mu link function:  identity
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 13.41228    0.43597   30.77   &lt;2e-16 ***
age          0.48394    0.01593   30.38   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  log
Sigma Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.765940   0.065727 -26.868   &lt;2e-16 ***
age          0.002114   0.001097   1.928    0.055 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Nu link function:  identity 
Nu Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.389413   0.431880  -0.902    0.368
age         -0.007446   0.006028  -1.235    0.218

------------------------------------------------------------------
Tau link function:  log 
Tau Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.8196     0.1432   5.722 3.09e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  250 
Degrees of Freedom for the fit:  7
      Residual Deg. of Freedom:  243 
                      at cycle:  7 
 
Global Deviance:     1624.405 
            AIC:     1638.405 
            SBC:     1663.056 
******************************************************************</code></pre>
</div>
</div>
</section>
<section id="summary-2" class="slide level2">
<h2>Summary 2</h2>
<div>
<ul>
<li class="fragment"><p>We can model things other than the mean!</p></li>
<li class="fragment"><p>In the old days (when I was training) this would have been very difficult</p></li>
<li class="fragment"><p>Now <code>gamlss</code> and Bayesian analysis makes it easy</p></li>
<li class="fragment"><p>How good does a model need to be?</p></li>
</ul>
</div>
</section>
<section id="learning-objectives-for-today" class="slide level2 smaller">
<h2>Learning objectives for today</h2>
<div>
<ul>
<li class="fragment">Distributions and Modelling
<ul>
<li class="fragment">Estimating parameters with linear models</li>
<li class="fragment">Re-framing <em>all</em> hypothesis tests as linear models</li>
<li class="fragment">Continuous and discrete predictors</li>
<li class="fragment">Interpreting and diagnosing models</li>
</ul></li>
<li class="fragment">Extensions and generalisations:
<ul>
<li class="fragment">Multiple predictors / interactions (more complex hypotheses)</li>
<li class="fragment">Log-transformations</li>
<li class="fragment">Logistic regression for binary data</li>
</ul></li>
</ul>
</div>
</section>
<section id="aim" class="slide level2">
<h2>Aim</h2>
<ul>
<li><p>Start to understand the ‘modelling’ approach to statistics</p></li>
<li><p>Enable you to explore this extensive framework to do almost any kind of statistical / ML analysis</p></li>
<li><p>Get familiar with how to do this in R</p></li>
<li><p>Become a statistician?</p></li>
</ul>
</section>
<section id="about-me" class="slide level2">
<h2>About me!</h2>
<div>
<ul>
<li class="fragment"><p>Statistician at Quadram Institute Bioscience since 2017</p></li>
<li class="fragment"><p>Support for epidemiology / genomics / ecology / clinical trials / pre-clinical research</p>
<ul>
<li class="fragment">Some statistical thinking goes a long way</li>
<li class="fragment">Many problems would be much simpler if they were re-framed in terms of linear models.</li>
<li class="fragment">Other approaches make life difficult and lead to inefficiencies and mistakes</li>
<li class="fragment">Statistics is a <span style="color:red">super-power!</span></li>
</ul></li>
</ul>
</div>
</section>
<section id="about-you" class="slide level2">
<h2>About you!</h2>
<ul>
<li>Name, previous work, experience with stats software.</li>
</ul>
</section></section>
<section>
<section id="inference-models-and-distributions" class="title-slide slide level1 center">
<h1>Inference, Models and Distributions</h1>

</section>
<section id="a-simple-motivating-problem" class="slide level2 smaller">
<h2>A simple motivating problem</h2>
<div>
<ul>
<li class="fragment"><p>Suppose we are interested in understanding the typical heights of UEA students?</p></li>
<li class="fragment"><p>How should we go about this?</p></li>
<li class="fragment"><p>Can you frame a question in mathematical / statistical terms.</p>
<ul>
<li class="fragment">What should the answer look like?</li>
<li class="fragment">How will we know we are done?</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Setting the question</strong></p>
</div>
<div class="callout-content">
<p>How should you set the scope of a statistical problem?</p>
</div>
</div>
</div>
</div>
</section>
<section id="inference" class="slide level2">
<h2>Inference</h2>
<ul>
<li><p>What is the <em>target population</em>?</p></li>
<li><p>What is the <em>sampling frame</em>?</p></li>
<li><p>What is the <em>sample</em>?</p></li>
</ul>
</section>
<section id="a-distribution-and-a-model" class="slide level2 incremental">
<h2>A distribution and a model</h2>
<ul>
<li><p>Students heights are not all the same, they have a ‘distribution’.</p></li>
<li><p>What kind of data is a ‘height?’</p></li>
<li><p>There is an average (central tendency) and a variance (spread).</p></li>
<li><p>We also have to assume or determine the shape of the distribution.</p></li>
<li><p>As a baseline - assume continuous variables are <strong>independently normally distributed</strong></p></li>
</ul>
</section>
<section id="model" class="slide level2">
<h2>Model</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>So, for example:</p>
<p>“Heights are normally distributed with mean 180cm and standard deviation 10cm”</p></li>
<li><p>We can represent this visually</p></li>
<li><p>Is it likely to be good enough to describe the distribution of student heights?</p></li>
</ul>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:40%;">
<div class="fragment fade-in">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-14-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Models</strong></p>
</div>
<div class="callout-content">
<p>What is a model?</p>
</div>
</div>
</div>
</div>
</section>
<section id="writing-this-model-mathematically" class="slide level2">
<h2>Writing this model mathematically</h2>
<p><span class="math display">\[\text{Height} \sim N(\text{mean} , \text{variance})\]</span></p>
<div class="fragment">
<p><span class="math display">\[H \sim N(\mu , \sigma^2)\]</span></p>
</div>
<div class="fragment">
<p>We describe how individual heights arise like this:</p>
<p><span class="math display">\[h_i = \mu + \epsilon_i\quad\text{where}\quad\epsilon_i \sim N(0,\sigma^2)\]</span></p>
</div>
<div class="fragment">
<p>The model has a <span style="color: green;">structural</span> part and an <span style="color: red;">error</span> part</p>
<p>This is the simplest linear model.</p>
</div>
</section>
<section id="so-what-is-a-model" class="slide level2 smaller">
<h2>So what is a model?</h2>
<p>Here’s our model for heights:</p>
<p><span class="math display">\[
\boxed{h_i = \mu + \epsilon_i\quad\text{where}\quad\epsilon_i \sim N(0,\sigma^2)}
\]</span></p>
<div>
<ul>
<li class="fragment"><p>A model is a mathematical or statistical way of writing down how we think our outcome is distributed</p></li>
<li class="fragment"><p>The model needs to be good enough for the purpose!</p>
<ul>
<li class="fragment"><strong><em>All models are wrong, but some are useful</em></strong></li>
</ul></li>
<li class="fragment"><p>It needs to link the aspects of the process we are interested in (<em>true but unknown</em> mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>) to the data that we can <em>observe</em> (<span class="math inline">\(h_i\)</span>).</p>
<ul>
<li class="fragment">Here it’s just a mean and variance we want to learn about but we can add things to this equation if we think they affect height.</li>
</ul></li>
</ul>
</div>
</section>
<section id="do-i-need-a-model-to-do-analysis" class="slide level2">
<h2>Do I <em>need</em> a model to do analysis?</h2>
<ul>
<li><p>Yes! Whenever you’re doing any kind of statistics there is an underlying model.</p></li>
<li><p>An implicit understanding of how your data came to be</p>
<ul>
<li><strong>how the data is generated</strong> and</li>
<li><strong>how it was collected.</strong></li>
</ul></li>
<li><p><em>Ad hoc</em> statistical procedures sometimes obscure hide these assumptions</p></li>
<li><p>But with linear modelling they are more explicit.</p></li>
</ul>
</section></section>
<section>
<section id="doing-statistics" class="title-slide slide level1 center">
<h1>‘Doing’ statistics</h1>

</section>
<section id="doing-statistics-with-the-model" class="slide level2">
<h2>Doing statistics with the model</h2>
<ul>
<li>Our model:</li>
</ul>
<div class="fragment">
<p><span class="math display">\[h_i = \mu + \epsilon_i\quad\text{where}\quad\epsilon_i \sim N(0,\sigma^2)\]</span></p>
<ul>
<li>If we estimate <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\epsilon\)</span>, we have describes the height distribution and we are done!</li>
</ul>
</div>
<div class="fragment">
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Key insight!</strong></p>
</div>
<div class="callout-content">
<p>Once we have a model, <em>all</em> of statistical analysis is just estimating model parameters!</p>
</div>
</div>
</div>
</div>
</section>
<section id="estimating-the-model" class="slide level2">
<h2>Estimating the model</h2>
<ul>
<li><p>We can use data to estimate the parameters</p></li>
<li><p>If we get enough <span class="math inline">\(h_i\)</span>’s (at least 2!) we can estimate the values of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p></li>
<li><p>Several ways these models are estimated:</p>
<ul>
<li>Numerical optimisation</li>
<li>Solving with algebra</li>
<li>Maximum likelihood</li>
<li>Bayesian resampling</li>
</ul></li>
<li><p>(Not getting into this..the computer will do it)</p></li>
</ul>
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>We can use this logic to show that the sample mean is the best estimate for the <span class="math inline">\(\mu\)</span></p>
</div>
</div>
</div>
</section>
<section id="estimating-the-model-using-r" class="slide level2">
<h2>Estimating the model using R</h2>
<p>Enter some data and check it’s OK:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>height <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">173</span>,<span class="dv">177</span>,<span class="dv">160</span>,<span class="dv">165</span>,<span class="dv">172</span>,<span class="dv">182</span>,<span class="dv">157</span>,<span class="dv">175</span>,<span class="dv">167</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(height)</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  height
1    173
2    177
3    160
4    165
5    172
6    182</code></pre>
</div>
</div>
<p>Estimate the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( height <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data=</span>dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>Display the model summary:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = height ~ 1, data = dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-12.778  -4.778   2.222   5.222  12.222 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  169.778      2.722   62.37 4.86e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.167 on 8 degrees of freedom</code></pre>
</div>
</div>
</section>
<section id="uncertainty" class="slide level2 incremental">
<h2>Uncertainty</h2>
<ul>
<li><p>Is our parameter estimate perfect? Have we completely discovered the average height of UEA students?</p></li>
<li><p>The confidence interval and standard error reflect the uncertainty in the estimate.</p></li>
<li><p>(There is also uncertainty in the standard deviation estimate, but this is harder to calculate using R and we don’t often use it.)</p></li>
</ul>
</section>
<section id="thinking-about-uncertainty" class="slide level2">
<h2>Thinking about uncertainty</h2>
<p>What can we really say about the mean and spread of student heights?</p>
<p>Is it plausible that the true mean height is 170cm?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">linearHypothesis</span>(model1, <span class="st">"(Intercept)=170"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear hypothesis test

Hypothesis:
(Intercept) = 170

Model 1: restricted model
Model 2: height ~ 1

  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1      9 534.00                           
2      8 533.56  1   0.44444 0.0067 0.9369</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Try some other values. 160cm, 163cm?</p>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">confint</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               2.5 %   97.5 %
(Intercept) 163.5003 176.0552</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(model1 , <span class="at">conf.int=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 7
  term        estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)     170.      2.72      62.4 4.86e-12     164.      176.</code></pre>
</div>
</div>
<ul>
<li><p>The confidence interval gives us every <em>plausible</em> value of the parameter given the data.</p></li>
<li><p>That is, every value not rejected at p&lt;0.05 (for a 95% interval)</p></li>
</ul>
</section>
<section id="diagnostics" class="slide level2">
<h2>Diagnostics</h2>
<ul>
<li><p>How good is our model? What were the model assumptions?</p></li>
<li><p>Heights are normally distributed</p></li>
<li><p>Individuals heights are independent of each other</p></li>
<li><p>(Our sample is representative)</p></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li><p>How can we check normality?</p></li>
<li><p>A <code>qqplot</code> compares model residuals with a normal distribution:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">plot</span>(model1 , <span class="at">which=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"><ul>
<li>How might we check assumptions of independence and representativeness?</li>
</ul>
</section>
<section id="summary-3" class="slide level2">
<h2>Summary 3</h2>
<ul>
<li><p>Statistical inference is trying to estimate something fixed but unknown in a population using observed data in a sample</p></li>
<li><p>The model links the unknown parameters to the observed data</p></li>
<li><p>Allows us to do prediction and inference</p></li>
<li><p>There is a duality between confidence intervals and p-values</p></li>
<li><p>We can check normality using qqplots. A visual inspection like this is better than statistical <code>tests</code> for normality that you might see.</p></li>
</ul>
</section></section>
<section>
<section id="adelaide-data" class="title-slide slide level1 center">
<h1>Adelaide data</h1>

</section>
<section id="exercise" class="slide level2">
<h2>Exercise</h2>
<p>A student questionnaire was conducted at Adelaide University. We’ll use this dataset to answer some interesting questions.</p>
<ol type="1">
<li><p>Load data into R (from <code>"survey.xlsx"</code>)</p></li>
<li><p>Estimate a model in R to find the distribution of student heights.</p></li>
<li><p>Check whether the heights are normally distributed</p></li>
<li><p>Check whether using the <code>mean</code> and <code>sd</code> functions in R gives you the same answer.</p></li>
</ol>
</section></section>
<section>
<section id="extending-our-linear-model" class="title-slide slide level1 center">
<h1>Extending our linear model</h1>

</section>
<section id="adding-a-predictor" class="slide level2 smaller">
<h2>Adding a predictor</h2>
<div>
<ul>
<li class="fragment"><p>Let’s improve our model.</p></li>
<li class="fragment"><p>Remind ourselves of the purpose of a model</p>
<ul>
<li class="fragment"><p>We might have a specific hypothesis to test</p></li>
<li class="fragment"><p>Or we might want to predict an outcome for a new individual</p></li>
<li class="fragment"><p>Or just understand the factors that contribute to our outcome in a population</p></li>
</ul></li>
<li class="fragment"><p>Can we improve our height prediction?</p></li>
<li class="fragment"><p>Can we add a factor to our model that helps to explain height?</p></li>
</ul>
</div>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<p>Different average for men and women.</p>
<div class="fragment">
<p>We might write this as:</p>
<p><span class="math display">\[
h_i=\left\{\begin{array}{ll}
\mu_\text{male} + \epsilon_i &amp; \text{(if male)}\\
\mu_\text{female} + \epsilon_i &amp; \text{(if female)}
\end{array}\right.\quad\text{where}\quad\epsilon_i \sim N(0,\sigma^2)
\]</span></p>
</div>
<div class="fragment">
<p>But we would usually write this as:</p>
<p><span class="math display">\[
\boxed{h_i = \mu + \beta x_i+\epsilon_i \quad\text{where}\quad \left\{\begin{array}{ll}
x_i=1 &amp;\text{if male;}\\
x_i=0 &amp; \text{if female}
\end{array}\right.}
\]</span></p>
</div>
<div class="fragment">
<p>Can you interpret this model?</p>
</div>
<div class="fragment">
<p>What are the mean heights for men and women under this model?</p>
</div>
<div class="fragment">
<p>What does <span class="math inline">\(\beta\)</span> represent?</p>
</div>
</section>
<section id="estimating-our-new-model-using-r" class="slide level2">
<h2>Estimating our new model using R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"survey.xlsx"</span>, <span class="at">na=</span><span class="st">"NA"</span>) <span class="sc">|&gt;</span> <span class="fu">remove_missing</span>()</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="fu">table</span>(dat<span class="sc">$</span>Sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Female   Male 
    84     84 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 13
   ...1 Sex    Wr.Hnd NW.Hnd W.Hnd Fold    Pulse Clap  Exer  Smoke Height M.I   
  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt; 
1     1 Female   18.5   18   Right R on L     92 Left  Some  Never   173  Metric
2     2 Male     19.5   20.5 Left  R on L    104 Left  None  Regul   178. Imper~
3     5 Male     20     20   Right Neither    35 Right Some  Never   165  Metric
4     6 Female   18     17.7 Right L on R     64 Right Some  Never   173. Imper~
5     7 Male     17.7   17.7 Right L on R     83 Right Freq  Never   183. Imper~
6     8 Female   17     17.3 Right R on L     74 Right Freq  Never   157  Metric
# ... with 1 more variable: Age &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="plotting" class="slide level2">
<h2>Plotting</h2>
<p>A graph is a good way to start modelling!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">ggplot</span>(dat , <span class="fu">aes</span>(<span class="at">x=</span>Sex, <span class="at">y=</span>Height)) <span class="sc">+</span> </span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">geom_beeswarm</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section id="estimating-with-r" class="slide level2">
<h2>Estimating with R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Height <span class="sc">~</span> Sex , <span class="at">data=</span>dat)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="fu">extract_eq</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{Height} = \alpha + \beta_{1}(\operatorname{Sex}_{\operatorname{Male}}) + \epsilon
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">extract_eq</span>(model2 , <span class="at">use_coefs=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{Height}} = 165.6 + 13.75(\operatorname{Sex}_{\operatorname{Male}})
\]</span></p>
</div>
</div>
</section>
<section id="diagnostic-plots" class="slide level2">
<h2>Diagnostic plots</h2>
<p>How well does our model fit its assupmtions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="fu">plot</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-24-1.png" width="960" class="r-stretch"></section>
<section id="interpretation" class="slide level2">
<h2>Interpretation</h2>
<ul>
<li>Interpreting coefficients and confidence intervals</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">tidy</span>(model2, <span class="at">conf.int=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 7
  term        estimate std.error statistic   p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    166.      0.787     211.  1.80e-203    164.      167. 
2 SexMale         13.7     1.11       12.4 2.71e- 25     11.6      15.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">extract_eq</span>(model2, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{Height}} = 165.6 + 13.75(\operatorname{Sex}_{\operatorname{Male}})
\]</span></p>
</div>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li>Marginal means</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">emmeans</span>(model2 , <span class="sc">~</span>Sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Sex    emmean    SE  df lower.CL upper.CL
 Female    166 0.787 166      164      167
 Male      179 0.787 166      178      181

Confidence level used: 0.95 </code></pre>
</div>
</div>
<ul>
<li>Comparing models</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Height <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data=</span>dat)</span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="fu">anova</span>(model1, model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Height ~ 1
Model 2: Height ~ Sex
  Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
1    167 16565.1                                  
2    166  8627.5  1    7937.6 152.72 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</section>
<section id="summary-4" class="slide level2">
<h2>Summary 4</h2>
<ul>
<li><p>A linear model can be used to replace a t-test</p></li>
<li><p>(Comparison of a single outcome across two independent groups)</p></li>
<li><p>Why should we prefer this to a t-test?</p></li>
</ul>
</section>
<section id="a-multiple-regression" class="slide level2">
<h2>A multiple regression</h2>
<p>Let’s repeat this process to understand how hand span depends on height.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>dat, <span class="fu">aes</span>(Height, Wr.Hnd, <span class="at">shape=</span>Sex)) <span class="sc">+</span> <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-28-1.png" width="960" class="r-stretch"><p>Can you write down a model for how hand span depends on height? Can you estimate it using R?</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>dat, Wr.Hnd <span class="sc">~</span> Height)</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Wr.Hnd ~ Height, data = dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8644 -0.8644  0.0230  0.8140  4.8044 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -2.83544    1.96131  -1.446     0.15    
Height       0.12545    0.01135  11.051   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.461 on 166 degrees of freedom
Multiple R-squared:  0.4238,    Adjusted R-squared:  0.4204 
F-statistic: 122.1 on 1 and 166 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Interpret and diagnose (test model assumptions) this model</p>
</section>
<section id="multiple-predictors" class="slide level2">
<h2>Multiple predictors</h2>
<p>Can we better explain the hand width model by adding a second predictor?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>model4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>dat, Wr.Hnd <span class="sc">~</span> Height <span class="sc">+</span> Sex)</span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="fu">summary</span>(model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Wr.Hnd ~ Height + Sex, data = dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5715 -0.8668  0.0558  0.9587  3.9863 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.90837    2.49397   1.567    0.119    
Height       0.08281    0.01503   5.509 1.36e-07 ***
SexMale      1.22353    0.29853   4.099 6.51e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.396 on 165 degrees of freedom
Multiple R-squared:  0.4771,    Adjusted R-squared:  0.4707 
F-statistic: 75.27 on 2 and 165 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Compare the two models. What do they tell you? Which is fitting the data better?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">extract_eq</span>(model3, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{Wr.Hnd}} = -2.84 + 0.13(\operatorname{Height})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">extract_eq</span>(model4, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{Wr.Hnd}} = 3.91 + 0.08(\operatorname{Height}) + 1.22(\operatorname{Sex}_{\operatorname{Male}})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">sigma</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.461155</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">sigma</span>(model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.396227</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Is the new model <em>significantly</em> better?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">anova</span>(model4, model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Wr.Hnd ~ Height + Sex
Model 2: Wr.Hnd ~ Height
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1    165 321.66                                  
2    166 354.41 -1   -32.747 16.798 6.508e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="predictions" class="slide level2">
<h2>Predictions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>(<span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">augment</span>(model3), <span class="fu">aes</span>(Height, Wr.Hnd)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted), <span class="at">lwd=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>(<span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">augment</span>(model4), <span class="fu">aes</span>(Height, Wr.Hnd, <span class="at">color=</span>Sex)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted), <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span><span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section id="interactions" class="slide level2 smaller">
<h2>Interactions</h2>
<p>Finally, we might ask if there’s any evidence that the slope is different between men and women.</p>
<p>How could we make a model to test this hypothesis?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>model5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>dat, Wr.Hnd <span class="sc">~</span> Height <span class="sc">+</span> Sex <span class="sc">+</span> Height<span class="sc">:</span>Sex)</span>
<span id="cb62-2"><a href="#cb62-2"></a>model5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>dat, Wr.Hnd <span class="sc">~</span> Height <span class="sc">*</span> Sex)</span>
<span id="cb62-3"><a href="#cb62-3"></a><span class="fu">extract_eq</span>(model5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{Wr.Hnd} = \alpha + \beta_{1}(\operatorname{Height}) + \beta_{2}(\operatorname{Sex}_{\operatorname{Male}}) + \beta_{3}(\operatorname{Height} \times \operatorname{Sex}_{\operatorname{Male}}) + \epsilon
\]</span></p>
</div>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="fu">summary</span>(model5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Wr.Hnd ~ Height * Sex, data = dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5776 -0.8609  0.0488  0.9659  4.0437 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)     5.58874    4.37585   1.277   0.2033   
Height          0.07266    0.02641   2.751   0.0066 **
SexMale        -1.33531    5.47715  -0.244   0.8077   
Height:SexMale  0.01505    0.03216   0.468   0.6405   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.4 on 164 degrees of freedom
Multiple R-squared:  0.4778,    Adjusted R-squared:  0.4682 
F-statistic: 50.01 on 3 and 164 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">extract_eq</span>(model4, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{Wr.Hnd}} = 3.91 + 0.08(\operatorname{Height}) + 1.22(\operatorname{Sex}_{\operatorname{Male}})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">extract_eq</span>(model5, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>, <span class="at">wrap=</span><span class="cn">TRUE</span>, <span class="at">terms_per_line =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\begin{aligned}
\operatorname{\widehat{Wr.Hnd}} &amp;= 5.59 + 0.07(\operatorname{Height})\ - \\
&amp;\quad 1.34(\operatorname{Sex}_{\operatorname{Male}}) + 0.02(\operatorname{Height} \times \operatorname{Sex}_{\operatorname{Male}})
\end{aligned}
\]</span></p>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>(<span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">augment</span>(model3), <span class="fu">aes</span>(Height, Wr.Hnd)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted), <span class="at">lwd=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>(<span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">augment</span>(model4), <span class="fu">aes</span>(Height, Wr.Hnd, <span class="at">color=</span>Sex)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted), <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span><span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>))) <span class="sc">+</span> </span>
<span id="cb67-3"><a href="#cb67-3"></a>(<span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">augment</span>(model5), <span class="fu">aes</span>(Height, Wr.Hnd, <span class="at">color=</span>Sex)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted), <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span><span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>))) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4"></a>  <span class="fu">plot_layout</span>(<span class="at">guides=</span><span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-37-1.png" width="960" class="r-stretch"></section>
<section id="model-comparison" class="slide level2 smaller">
<h2>Model comparison</h2>
<p>ANOVA compares the (1) improvement in fit between models to (2) the improvement that would be expected if there was no real difference in the population.</p>
<p>The p-values reflect the statistical significance of the improvement as we increase the model complexity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">anova</span>(model3, model4, model5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Wr.Hnd ~ Height
Model 2: Wr.Hnd ~ Height + Sex
Model 3: Wr.Hnd ~ Height * Sex
  Res.Df    RSS Df Sum of Sq       F    Pr(&gt;F)    
1    166 354.41                                   
2    165 321.66  1    32.747 16.7184 6.777e-05 ***
3    164 321.23  1     0.429  0.2189    0.6405    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Is the interaction term needed?</p>
</section>
<section id="summary" class="slide level2 incremental">
<h2>Summary</h2>
<ul>
<li>We can add multiple predictors to improve a model</li>
<li>Linear models can replace ANCOVA</li>
<li>Interactions tell us whether effects are different across sub-groups</li>
<li>Models can be compared using p-values to test whether additional terms are needed</li>
</ul>
</section></section>
<section>
<section id="extensions" class="title-slide slide level1 center">
<h1>Extensions</h1>

</section>
<section id="everything-is-a-linear-model" class="slide level2 smaller">
<h2>Everything is a linear model</h2>
<p>What statistical tests/procedures have we replaced with a linear model?</p>
<ul>
<li>Unpaired T-test</li>
<li>Correlation</li>
<li>ANOVA</li>
<li>ANCOVA</li>
</ul>
<p>All other statistical tests can be reframed in this way:</p>
<ul>
<li>Models for count or categorical outcomes</li>
<li>Paired data</li>
<li>Non-parametric tests</li>
<li>More complex machine learning</li>
<li>Non-linear models are usually straightforward extensions</li>
</ul>
<p><a href="https://lindeloev.github.io/tests-as-linear/#9_teaching_materials_and_a_course_outline" class="uri">https://lindeloev.github.io/tests-as-linear/#9_teaching_materials_and_a_course_outline</a></p>
</section>
<section id="exercise-1" class="slide level2 smaller">
<h2>Exercise</h2>
<p>Look at the diversity data in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>diversityDay <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"diversity.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is data from a real experiment to explore gut microbial diversity over time in hospital patients.</p>
<p>We’ll use linear models to test whether <code>diversity</code> changes over <code>time</code>.</p>
<ol type="1">
<li>What is the mean and standard deviation of diversity across all samples?</li>
<li>Plot how microbial diversity varies with time.</li>
<li>Is microbial diversity <em>correlated</em> with time?</li>
<li>Is the correlation statistically significant?</li>
<li>What happens if we adjust for patient (add patient to the model)?</li>
</ol>
</section>
<section id="dealing-with-non-normal-data" class="slide level2 incremental">
<h2>Dealing with non-normal data</h2>
<ul>
<li><p>So far we’ve seen data that can be modelled using normal distributions, where the relationships are genuinely straight lines.</p></li>
<li><p>Biological data very often does not act like this</p></li>
<li><p>What options do we have?</p></li>
<li><p>Funkier models?</p></li>
<li><p>Transformations?</p></li>
</ul>
</section>
<section id="animal-traits" class="slide level2">
<h2>Animal traits</h2>
<p>The body mass of animals is linked to their metabolic rate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>animals <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"observations.csv"</span>)</span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="fu">ggplot</span>(animals, <span class="fu">aes</span>(body.mass,metabolic.rate,<span class="at">col=</span>phylum)) <span class="sc">+</span> </span>
<span id="cb71-3"><a href="#cb71-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>phylum, <span class="at">scale=</span><span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-40-1.png" width="960" class="r-stretch"><p>Can we fit a linear model to this?</p>
</section>
<section id="logarithmic-transformation" class="slide level2">
<h2>Logarithmic transformation</h2>
<p>The same data plotted on a different scale:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="fu">ggplot</span>(animals, <span class="fu">aes</span>(body.mass,metabolic.rate,<span class="at">col=</span>phylum)) <span class="sc">+</span> </span>
<span id="cb72-2"><a href="#cb72-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-41-1.png" width="960" class="r-stretch"></section>
<section id="logarithmic-transformations" class="slide level2 smaller">
<h2>Logarithmic transformations</h2>
<p>Instead of modelling how <span class="math inline">\(y\)</span> depends on <span class="math inline">\(x\)</span>, we can model how <span class="math inline">\(\log(y)\)</span> depends on <span class="math inline">\(\log(x)\)</span>.</p>
<div class="fragment">
<ul>
<li>This is a very commonly used approach and it is surprising how often and how well it works.</li>
</ul>
<p><span class="math display">\[\log(y_i) = a + b\log(x_i) + \epsilon_i\]</span></p>
</div>
<div class="fragment">
<ul>
<li>Implies</li>
</ul>
<p><span class="math display">\[y_i = \exp(a + b\log(x_i) + e) = e^a\times x_i^{b}\times e^{\epsilon_i}\]</span></p>
<ul>
<li><p>So instead of an additive model, we have a multiplicative one.</p></li>
<li><p>But we estimate using R as a regular linear model, using <span class="math inline">\(\log(y)\)</span> as the outcome and <span class="math inline">\(\log(x)\)</span> as the predictor.</p></li>
</ul>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>modelAnimals <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>animals , <span class="fu">log</span>(metabolic.rate) <span class="sc">~</span> <span class="fu">log</span>(body.mass)<span class="sc">*</span>phylum)</span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="fu">summary</span>(modelAnimals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(metabolic.rate) ~ log(body.mass) * phylum, data = animals)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8236 -0.4098  0.0867  0.5732  2.4220 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   -0.55146    0.15437  -3.572 0.000368 ***
log(body.mass)                 0.86224    0.01496  57.641  &lt; 2e-16 ***
phylumChordata                 1.45940    0.16753   8.711  &lt; 2e-16 ***
log(body.mass):phylumChordata -0.25689    0.02493 -10.305  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9566 on 1180 degrees of freedom
  (2394 observations deleted due to missingness)
Multiple R-squared:  0.9588,    Adjusted R-squared:  0.9587 
F-statistic:  9161 on 3 and 1180 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">augment</span>(modelAnimals, <span class="at">interval=</span><span class="st">"prediction"</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">log(body.mass)</span><span class="st">`</span>, <span class="at">y=</span><span class="st">`</span><span class="at">log(metabolic.rate)</span><span class="st">`</span>, <span class="at">col=</span>phylum, <span class="at">fill=</span>phylum)) <span class="sc">+</span>  </span>
<span id="cb75-3"><a href="#cb75-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb75-4"><a href="#cb75-4"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted)) <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted,<span class="at">ymin=</span>.lower,<span class="at">ymax=</span>.upper),<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb75-6"><a href="#cb75-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>phylum, <span class="at">scale=</span><span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-43-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>animals<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelAnimals, <span class="at">newdata =</span> animals, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a></span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="fu">augment</span>(modelAnimals, <span class="at">interval=</span><span class="st">"prediction"</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-4"><a href="#cb76-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">exp</span>(<span class="st">`</span><span class="at">log(body.mass)</span><span class="st">`</span>), <span class="at">y=</span><span class="fu">exp</span>(<span class="st">`</span><span class="at">log(metabolic.rate)</span><span class="st">`</span>), <span class="at">col=</span>phylum, <span class="at">fill=</span>phylum)) <span class="sc">+</span>  </span>
<span id="cb76-5"><a href="#cb76-5"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb76-6"><a href="#cb76-6"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">exp</span>(.fitted))) <span class="sc">+</span></span>
<span id="cb76-7"><a href="#cb76-7"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">exp</span>(.fitted),<span class="at">ymin=</span><span class="fu">exp</span>(.lower),<span class="at">ymax=</span><span class="fu">exp</span>(.upper)),<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb76-8"><a href="#cb76-8"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>phylum, <span class="at">scale=</span><span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="presentation_files/figure-revealjs/unnamed-chunk-44-1.png" width="960" class="r-stretch"></section>
<section id="summary-5" class="slide level2">
<h2>Summary 5</h2>
<ul>
<li><p>Linear models can be useful for data that does not look linear!</p></li>
<li><p>Next time:</p></li>
<li><p>Binary data (logistic regression)</p></li>
<li><p>Multilevel models (more complex errors)</p></li>
</ul>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="presentation_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="presentation_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>